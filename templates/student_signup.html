<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Sign Up</title>
    <!-- Link to your CSS files -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/components.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/layout.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/form.css') }}">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <main class="main-content">
        <div class="container">
            <div class="form-header">
                <h2 class="form-title">Create Student Account</h2>
                <p class="section-subtitle">Join our learning community today</p>
            </div>

            <!-- Flash messages -->
            <div class="flash-messages">
                {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}

                {% for category, message in messages %}
                <div class="alert alert-{{ category }}">
                    {{ message }}
                </div>
                {% endfor %}

                {% endif %}
                {% endwith %}
            </div>

            <form id="signup-form" class="form-container" method="POST" action="/student_signup">
                <div class="form-grid">
                    <!-- Student Name -->
                    <div class="form-group">
                        <label for="studentName" class="form-label">Student Name</label>
                        <input type="text" id="studentName" name="studentName" class="form-control"
                            placeholder="Enter student name" required
                            value="{{ form_data.student_name if form_data.student_name else '' }}">
                    </div>

                    <!-- Father's Name -->
                    <div class="form-group">
                        <label for="fatherName" class="form-label">Father's Name</label>
                        <input type="text" id="fatherName" name="fatherName" class="form-control"
                            placeholder="Enter father's name" required
                            value="{{ form_data.father_name if form_data.father_name else '' }}">
                    </div>

                    <!-- Mother's Name -->
                    <div class="form-group">
                        <label for="motherName" class="form-label">Mother's Name</label>
                        <input type="text" id="motherName" name="motherName" class="form-control"
                            placeholder="Enter mother's name" required
                            value="{{ form_data.mother_name if form_data.mother_name else '' }}">
                    </div>

                    <!-- Gender Dropdown -->
                    <div class="form-group">
                        <label for="gender" class="form-label">Gender</label>
                        <select id="gender" name="gender" class="form-control form-select" required>
                            <option value="">Select Gender</option>
                            <option value="Male" {% if form_data.gender == 'Male' %}selected{% endif %}>Male</option>
                            <option value="Female" {% if form_data.gender == 'Female' %}selected{% endif %}>Female
                            </option>
                            <option value="Other" {% if form_data.gender == 'Other' %}selected{% endif %}>Other</option>
                        </select>
                    </div>

                    <!-- CAN ID -->
                    <div class="form-group">
                        <label for="canId" class="form-label">CAN ID</label>
                        <input type="text" id="canId" name="canId" class="form-control" placeholder="Enter CAN ID"
                            required value="{{ form_data.can_id if form_data.can_id else '' }}">
                    </div>

                    <!-- Mobile Number -->
                    <div class="form-group">
                        <label for="mobile" class="form-label">Mobile Number</label>
                        <input type="tel" id="mobile" name="mobile" class="form-control" pattern="[0-9]{10}"
                            title="Please enter a 10-digit phone number" placeholder="Enter mobile number" required
                            value="{{ form_data.mobile if form_data.mobile else '' }}">
                    </div>

                    <!-- Religion Dropdown -->
                    <div class="form-group">
                        <label for="religion" class="form-label">Religion</label>
                        <select id="religion" name="religion" class="form-control form-select" required>
                            <option value="">Select Religion</option>
                            <option value="Hindu" {% if form_data.religion == 'Hindu' %}selected{% endif %}>Hindu
                            </option>
                            <option value="Muslim" {% if form_data.religion == 'Muslim' %}selected{% endif %}>Muslim
                            </option>
                            <option value="Christian" {% if form_data.religion == 'Christian' %}selected{% endif %}>
                                Christian</option>
                            <option value="Sikh" {% if form_data.religion == 'Sikh' %}selected{% endif %}>Sikh</option>
                            <option value="Jain" {% if form_data.religion == 'Jain' %}selected{% endif %}>Jain</option>
                            <option value="Buddhist" {% if form_data.religion == 'Buddhist' %}selected{% endif %}>
                                Buddhist</option>
                            <option value="Other" {% if form_data.religion == 'Other' %}selected{% endif %}>Other
                            </option>
                        </select>
                    </div>

                    <!-- Category Dropdown -->
                    <div class="form-group">
                        <label for="category" class="form-label">Category</label>
                        <select id="category" name="category" class="form-control form-select" required>
                            <option value="">Select Category</option>
                            <option value="General" {% if form_data.category == 'General' %}selected{% endif %}>General
                            </option>
                            <option value="OBC" {% if form_data.category == 'OBC' %}selected{% endif %}>OBC</option>
                            <option value="SC" {% if form_data.category == 'SC' %}selected{% endif %}>SC</option>
                            <option value="ST" {% if form_data.category == 'ST' %}selected{% endif %}>ST</option>
                            <option value="Other" {% if form_data.category == 'Other' %}selected{% endif %}>Other
                            </option>
                        </select>
                    </div>

                    <!-- Date of Birth -->
                    <div class="form-group">
                        <label for="dob" class="form-label">Date of Birth</label>
                        <input type="date" id="dob" name="dob" class="form-control" required
                            value="{{ form_data.dob if form_data.dob else '' }}">
                    </div>

                    <!--District Name Dropdown -->
                    <div class="form-group">
                        <label for="district" class="form-label">District</label>
                        <select id="district" name="district" class="form-control form-select" required>
                            <option value="">Select District</option>
                            <option value="Bilaspur" {% if form_data.district == 'Bilaspur' %}selected{% endif %}>
                                Bilaspur
                            </option>
                            <option value="Chamba" {% if form_data.district == 'Chamba' %}selected{% endif %}>Chamba
                            </option>
                            <option value="Hamirpur" {% if form_data.district == 'Hamirpur' %}selected{% endif %}>
                                Hamirpur
                            </option>
                            <option value="Kangra" {% if form_data.district == 'Kangra' %}selected{% endif %}>Kangra
                            </option>
                            <option value="Kullu" {% if form_data.district == 'Kullu' %}selected{% endif %}>Kullu
                            </option>
                            <option value="Mandi" {% if form_data.district == 'Mandi' %}selected{% endif %}>Mandi
                            </option>
                            <option value="Sirmour" {% if form_data.district == 'Sirmour' %}selected{% endif %}>Sirmour
                            </option>
                            <option value="Solan" {% if form_data.district == 'Solan' %}selected{% endif %}>Solan
                            </option>
                            <option value="Una" {% if form_data.district == 'Una' %}selected{% endif %}>Una</option>
                        </select>
                    </div>

                    <!-- Sub-Center Selection -->
                    <div class="form-group">
                        <label for="center" class="form-label">Center</label>
                        <select id="center" name="center" class="form-control form-select" required>
                            <option value="">Select Center</option>
                            <!-- Options will be populated by JavaScript -->
                        </select>
                    </div>

                    <!-- Trade Dropdown -->
                    <div class="form-group">
                        <label for="trade" class="form-label">Trade</label>
                        <select id="trade" name="trade" class="form-control form-select" required>
                            <option value="">Select Trade</option>
                            <option value="Agriculture" {% if form_data.trade == 'Agriculture' %}selected{% endif %}>
                                Agriculture</option>
                            <option value="Beauty & Wellness"
                                {% if form_data.trade == 'Beauty & Wellness' %}selected{% endif %}>Beauty & Wellness
                            </option>
                            <option value="Plumbing" {% if form_data.trade == 'Plumbing' %}selected{% endif %}>Plumbing
                            </option>
                            <option value="Food Processing"
                                {% if form_data.trade == 'Food Processing' %}selected{% endif %}>Food Processing
                            </option>
                            <option value="Automotive" {% if form_data.trade == 'Automotive' %}selected{% endif %}>
                                Automotive</option>
                            <option value="Electronics" {% if form_data.trade == 'Electronics' %}selected{% endif %}>
                                Electronics</option>
                            <option value="Tourism & Hospitality"
                                {% if form_data.trade == 'Tourism & Hospitality' %}selected{% endif %}>Tourism &
                                Hospitality</option>
                            <option value="ITeS" {% if form_data.trade == 'ITeS' %}selected{% endif %}>ITeS</option>
                        </select>
                    </div>

                    <!-- Password -->
                    <div class="form-group">
                        <label for="password" class="form-label">Create Password</label>
                        <div class="password-input-container">
                            <input type="password" id="password" name="password" class="form-control"
                                placeholder="Create your password" required>

                            <span id="togglePassword" class="password-toggle">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                    </div>

                    <!-- Confirm Password -->
                    <div class="form-group">
                        <label for="confirmPassword" class="form-label">Confirm Password</label>
                        <div class="password-input-container">
                            <input type="password" id="confirmPassword" name="confirmPassword" class="form-control"
                                placeholder="Confirm your password" required>
                            <span id="toggleConfirmPassword" class="password-toggle">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Create Account</button>
                </div>
                <div class="alt-action">
                    <p>Already have an account? <a href="{{ url_for('student_signin') }}">Sign in</a></p>
                </div>
            </form>
        </div>
    </main>

    <script>
        // Toggle password visibility
        document.getElementById('togglePassword').addEventListener('click', function () {
            const passwordInput = document.getElementById('password');
            const icon = this.querySelector('i');

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                icon.classList.replace('fa-eye', 'fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                icon.classList.replace('fa-eye-slash', 'fa-eye');
            }
        });

        document.getElementById('toggleConfirmPassword').addEventListener('click', function () {
            const confirmPasswordInput = document.getElementById('confirmPassword');
            const icon = this.querySelector('i');

            if (confirmPasswordInput.type === 'password') {
                confirmPasswordInput.type = 'text';
                icon.classList.replace('fa-eye', 'fa-eye-slash');
            } else {
                confirmPasswordInput.type = 'password';
                icon.classList.replace('fa-eye-slash', 'fa-eye');
            }
        });

        // Fade out flash messages after 5 seconds
        setTimeout(() => {
            const alerts = document.querySelectorAll('.alert');
            alerts.forEach(alert => {
                alert.classList.add('fade-out');
                setTimeout(() => alert.remove(), 500);
            });
        }, 3000);

        // Center data for each district
        const centerData = {
            "Bilaspur": ["JHANDUTTA", "SADAR", "SHRI NAINA DEVI JI"],
            "Chamba": ["BANIKHET", "CHAMBA", "CHOWARI", "GAROLA", "GEHRA", "HARDASPURA", "KALHEL", "KIANI", "MEHLA",
                "SALOONI", "SIHUNTA", "SUNDLA", "TISSA"
            ],
            "Hamirpur": ["HAMIRPUR"],
            "Kangra": ["BAIJNATH", "NURPUR", "PANCHRUKHI", "RAIT"],
            "Kullu": ["ANNI", "BANJAR", "KULLU-1", "KULLU-2", "NAGGAR", "NIRMAND"],
            "Mandi": ["SADAR-2", "SERAJ-2"],
            "Sirmour": ["BAKRAS", "DADAHU", "NARAG", "PAONTA SAHIB", "RAJGARH", "SATAUN", "SHILLAI", "SURLA",
                "MAJRA"
            ],
            "Solan": ["ARKI", "DHARAMPUR", "DHUNDAN", "KANDAGHAT", "NALAGARH", "RAMSHEHAR"],
            "Una": ["AMB", "GAGRET-1", "HAROLI", "JOL", "UNA"]
        };

        // Function to update centers based on selected district
        function updateCenters() {
            const districtSelect = document.getElementById('district');
            const centerSelect = document.getElementById('center');
            const selectedDistrict = districtSelect.value;
            const currentCenter = "{{ form_data.center if form_data.center else '' }}";

            // Clear existing options
            centerSelect.innerHTML = '<option value="">Select Center</option>';

            if (selectedDistrict && centerData[selectedDistrict]) {
                centerSelect.disabled = false;

                // Add new options
                centerData[selectedDistrict].forEach(center => {
                    const option = document.createElement('option');
                    // Use the actual center name as both value and display text
                    option.value = center;
                    option.textContent = center;

                    // Preserve selected center if it matches
                    if (center === currentCenter) {
                        option.selected = true;
                    }

                    centerSelect.appendChild(option);
                });
            } else {
                centerSelect.disabled = true;
            }
        }

        // Initialize the form when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Add event listener for district change
            document.getElementById('district').addEventListener('change', updateCenters);
            
            // Initialize centers based on current district selection
            updateCenters();
            
            // If there's a form error and district was selected, make sure centers are properly populated
            const districtValue = "{{ form_data.district if form_data.district else '' }}";
            if (districtValue) {
                updateCenters();
            }
        });
    </script>
</body>
</html>